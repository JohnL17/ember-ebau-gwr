<h1>
  {{t "ember-gwr.searchProject.heading"}}
</h1>

<Search::Filters
  @search={{fn (perform this.search)}}
  @translationBase={{"ember-gwr.searchProject"}} as |Field|
>
  <div class="uk-flex uk-flex-wrap uk-flex-between">
    <div class="uk-width-1-3@m uk-width-1">
      <div class="uk-margin-small-right">
        <Field
          @attr="projectStatus"
          @inputType="select"
          @options={{this.projectStatusOptions}}
        />
      </div>
    </div>
    <div class="uk-width-1-3@m uk-width-1">
      <div class="uk-margin-small-right">
        <Field
          @attr="hasError"
          @inputType="select"
          @options={{array true false}}
        />
      </div>
    </div>
    <div class="uk-width-1-3@m uk-width-1">
      <div class="uk-margin-small-right">
        <Field @attr="realestateIdentification.number" type="number" />
      </div>
    </div>
  </div>

  {{#if this.extendedSearch}}
    <div class="uk-flex uk-flex-between uk-margin-small-bottom">
      <div class="uk-width-1-2">
        <h3>
          {{t "ember-gwr.searchProject.realestateIdentificationHeading"}}
        </h3>
        {{#if this.validationErrors.realestateIdentification}}
          <div class="uk-alert-danger" uk-alert>
            <p>
              {{this.validationErrors.realestateIdentification}}
            </p>
          </div>
        {{/if}}
        <Field @attr="realestateIdentification.EGRID" type="number" />
        <Field @attr="realestateIdentification.numberSuffix" type="number" />
        <Field @attr="realestateIdentification.subDistrict" type="number" />
        <Field @attr="realestateIdentification.lot" type="number" />
      </div>

      <div>
        <hr
          class="uk-divider-vertical uk-height-1-1 uk-margin-left uk-margin-right"
        />
      </div>

      <div class="uk-width-1-2">
        <div class="uk-margin">
          <h3>
            {{t "ember-gwr.searchProject.createDateHeading"}}
          </h3>
          {{#if this.validationErrors.createDate}}
            <div class="uk-alert-danger" uk-alert>
              <p>
                {{this.validationErrors.createDate}}
              </p>
            </div>
          {{/if}}
          <div class="uk-flex">
            <div class="uk-margin-small-right">
              <Field
                @attr="createDate.dateFrom"
                @noMargin={{true}}
                @inputType="date"
              />
            </div>
            <Field
              @attr="createDate.dateTo"
              @noMargin={{true}}
              @inputType="date"
            />
          </div>
        </div>

        <div class="uk-margin">
          <h3>
            {{t "ember-gwr.searchProject.modifyDateHeading"}}
          </h3>
          {{#if this.validationErrors.modifyDate}}
            <div class="uk-alert-danger" uk-alert>
              <p>
                {{this.validationErrors.modifyDate}}
              </p>
            </div>
          {{/if}}
          <div class="uk-flex">
            <div class="uk-margin-small-right">
              <Field
                @attr="modifyDate.dateFrom"
                @noMargin={{true}}
                @inputType="date"
              />
            </div>
            <Field
              @attr="modifyDate.dateTo"
              @noMargin={{true}}
              @inputType="date"
            />
          </div>
        </div>
      </div>
    </div>
  {{/if}}
  <div class="uk-flex uk-flex-right">
    <button
      type="button"
      class="uk-button uk-button-default"
      {{on "click" (fn (mut this.extendedSearch) (not this.extendedSearch))}}
    >
      {{t
        (concat
          "ember-gwr.searchProject.extendedSearch."
          (if this.extendedSearch "collapse" "extend")
        )
      }}
    </button>
    <button
      type="submit"
      class="uk-button uk-button-primary uk-margin-small-left"
    >
      {{t "ember-gwr.searchProject.search"}}
    </button>
  </div>
</Search::Filters>

{{#if this.search.last}}
  <Search::ResultTable
    @results={{this.searchResults}}
    @loading={{this.search.isRunning}} as |Row|
  >
    <Search::ResultTable::Head as |Header|>
      <Header
        class="uk-table-shrink"
        @label={{t "ember-gwr.constructionProject.fields.EPROID"}}
      />
      <Header
        class="uk-table-expand"
        @label={{
          t
          "ember-gwr.constructionProject.fields.constructionProjectDescription"
        }}
      />
      <Header @label={{t "ember-gwr.searchProject.projectStatus"}} />
    </Search::ResultTable::Head>
    <Row as |Field|>
      <Field @attr="EPROID" as |value|>
        <button
          class="uk-button uk-button-link"
          type="button"
          {{on "click" (fn this.linkProject value)}}
        >
          {{value}}
        </button>
      </Field>
      <Field @attr="constructionProjectDescription" />
      <Field @attr="projectStatus" as |value|>
        {{t (concat "ember-gwr.searchProject.projectStatusOptions." value)}}
      </Field>
    </Row>
  </Search::ResultTable>
{{/if}}
